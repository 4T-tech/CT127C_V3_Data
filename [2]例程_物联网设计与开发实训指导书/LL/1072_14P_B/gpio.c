/* USER CODE BEGIN Header */
/**
  ******************************************************************************
  * @file    gpio.c
  * @brief   This file provides code for the configuration
  *          of all used GPIO pins.
  ******************************************************************************
  * @attention
  *
  * Copyright (c) 2024 STMicroelectronics.
  * All rights reserved.
  *
  * This software is licensed under terms that can be found in the LICENSE file
  * in the root directory of this software component.
  * If no LICENSE file comes with this software, it is provided AS-IS.
  *
  ******************************************************************************
  */
/* USER CODE END Header */

/* Includes ------------------------------------------------------------------*/
#include "gpio.h"

/* USER CODE BEGIN 0 */

/* USER CODE END 0 */

/*----------------------------------------------------------------------------*/
/* Configure GPIO                                                             */
/*----------------------------------------------------------------------------*/
/* USER CODE BEGIN 1 */

/* USER CODE END 1 */

/** Configure pins as
        * Analog
        * Input
        * Output
        * EVENT_OUT
        * EXTI
*/
void MX_GPIO_Init(void)
{

  LL_GPIO_InitTypeDef GPIO_InitStruct = {0};

  /* GPIO Ports Clock Enable */
  LL_AHB2_GRP1_EnableClock(LL_AHB2_GRP1_PERIPH_GPIOB);
  LL_AHB2_GRP1_EnableClock(LL_AHB2_GRP1_PERIPH_GPIOA);
  LL_AHB2_GRP1_EnableClock(LL_AHB2_GRP1_PERIPH_GPIOC);

  /**/
  LL_GPIO_ResetOutputPin(GPIOB, LL_GPIO_PIN_5|LL_GPIO_PIN_2|LL_GPIO_PIN_12);

  /**/
  LL_GPIO_ResetOutputPin(GPIOA, LL_GPIO_PIN_4);

  /**/
  LL_GPIO_ResetOutputPin(GPIOC, LL_GPIO_PIN_13);

  /**/
  GPIO_InitStruct.Pin = LL_GPIO_PIN_5|LL_GPIO_PIN_2|LL_GPIO_PIN_12;
  GPIO_InitStruct.Mode = LL_GPIO_MODE_OUTPUT;
  GPIO_InitStruct.Speed = LL_GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.OutputType = LL_GPIO_OUTPUT_PUSHPULL;
  GPIO_InitStruct.Pull = LL_GPIO_PULL_NO;
  LL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /**/
  GPIO_InitStruct.Pin = LL_GPIO_PIN_8;
  GPIO_InitStruct.Mode = LL_GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = LL_GPIO_PULL_NO;
  LL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /**/
  GPIO_InitStruct.Pin = LL_GPIO_PIN_4;
  GPIO_InitStruct.Mode = LL_GPIO_MODE_OUTPUT;
  GPIO_InitStruct.Speed = LL_GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.OutputType = LL_GPIO_OUTPUT_PUSHPULL;
  GPIO_InitStruct.Pull = LL_GPIO_PULL_NO;
  LL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /**/
  GPIO_InitStruct.Pin = LL_GPIO_PIN_8;
  GPIO_InitStruct.Mode = LL_GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = LL_GPIO_PULL_NO;
  LL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  /**/
  GPIO_InitStruct.Pin = LL_GPIO_PIN_13;
  GPIO_InitStruct.Mode = LL_GPIO_MODE_OUTPUT;
  GPIO_InitStruct.Speed = LL_GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.OutputType = LL_GPIO_OUTPUT_PUSHPULL;
  GPIO_InitStruct.Pull = LL_GPIO_PULL_NO;
  LL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  GPIO_InitStruct.Pin = LL_GPIO_PIN_11|LL_GPIO_PIN_12;
  GPIO_InitStruct.Mode = LL_GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = LL_GPIO_PULL_UP;
  LL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  GPIO_InitStruct.Pin = LL_GPIO_PIN_0|LL_GPIO_PIN_15;
  GPIO_InitStruct.Mode = LL_GPIO_MODE_OUTPUT;
  GPIO_InitStruct.Pull = LL_GPIO_PULL_NO;
  LL_GPIO_Init(GPIOA, &GPIO_InitStruct);

  GPIO_InitStruct.Pin = LL_GPIO_PIN_3;
  LL_GPIO_Init(GPIOB, &GPIO_InitStruct);
}

/* USER CODE BEGIN 2 */
uint8_t KEY_Read(void)            	/* 按键读取 */
{
  uint8_t ucVal = 0;

  if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_8) == 0)
  {                                	/* SW1按键按下(PA8=0) */
    LL_mDelay(10);                 	/* 延时10ms消抖 */
    if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_8) == 0)
      ucVal = '1';                 	/* 赋值键值'1' */
  }
  if(LL_GPIO_IsInputPinSet(GPIOB, LL_GPIO_PIN_8) == 0)
  {                                	/* SW2按键按下(PB8=0) */
    LL_mDelay(10);                 	/* 延时10ms消抖 */
    if(LL_GPIO_IsInputPinSet(GPIOB, LL_GPIO_PIN_8) == 0)
      ucVal = '2';                 	/* 赋值键值'2' */
  }
  LL_GPIO_ResetOutputPin(GPIOB, LL_GPIO_PIN_3);
  LL_GPIO_SetOutputPin(GPIOA, LL_GPIO_PIN_15);
  LL_GPIO_SetOutputPin(GPIOA, LL_GPIO_PIN_0);
  if (LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_11|LL_GPIO_PIN_12) != 1)
  {                               	/* B1或B4按下 */
    LL_mDelay(10);			        		/* 延时10ms消抖 */
    if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_12) == 0)
      ucVal = 'B'+1;       	     		/* 赋值键值'C' */
    if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_11) == 0)
      ucVal = 'B'+4;  		       		/* 赋值键值'F' */
  }
  LL_GPIO_SetOutputPin(GPIOB, LL_GPIO_PIN_3);
  LL_GPIO_ResetOutputPin(GPIOA, LL_GPIO_PIN_15);
  if (LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_11|LL_GPIO_PIN_12) != 1)
  {                               	/* B2或B5按下 */
    LL_mDelay(10);			        		/* 延时10ms消抖 */
    if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_12) == 0)
      ucVal = 'B'+2;       	     		/* 赋值键值'D' */
    if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_11) == 0)
      ucVal = 'B'+5;  		       		/* 赋值键值'G' */
  }
  LL_GPIO_SetOutputPin(GPIOA, LL_GPIO_PIN_15);
  LL_GPIO_ResetOutputPin(GPIOA, LL_GPIO_PIN_0);
  if (LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_11|LL_GPIO_PIN_12) != 1)
  {                               	/* B3或B6按下 */
    LL_mDelay(10);			        		/* 延时10ms消抖 */
    if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_12) == 0)
      ucVal = 'B'+3;       	     		/* 赋值键值'E' */
    if(LL_GPIO_IsInputPinSet(GPIOA, LL_GPIO_PIN_11) == 0)
      ucVal = 'B'+6;  		       		/* 赋值键值'H' */
  }
  return ucVal;                    	/* 返回键值 */
}

void LED_Disp(uint8_t ucLed)      	/* LED显示 */
{
  if((ucLed&1) == 1)              	/* 点亮LD1 */
    LL_GPIO_ResetOutputPin(GPIOB, LL_GPIO_PIN_2);
  else                             	/* 熄灭LD1 */
    LL_GPIO_SetOutputPin(GPIOB, LL_GPIO_PIN_2);

  if((ucLed&2) == 2)               	/* 点亮LD2 */
    LL_GPIO_ResetOutputPin(GPIOB, LL_GPIO_PIN_5);
  else                             	/* 熄灭LD2 */
    LL_GPIO_SetOutputPin(GPIOB, LL_GPIO_PIN_5);

  if((ucLed&4) == 4)              	/* 点亮LD3 */
    LL_GPIO_ResetOutputPin(GPIOB, LL_GPIO_PIN_12);
  else                             	/* 熄灭LD3 */
    LL_GPIO_SetOutputPin(GPIOB, LL_GPIO_PIN_12);
}
/* USER CODE END 2 */
